"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[99],{14019:(z,x,s)=>{s.d(x,{C:()=>oe});var v=s(15861),p=s(24006),l=s(36517),y=s(92340),e=s(94650),c=s(12368),C=s(36895);function F(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"span",14),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2("(",t.tiempo," ",n.getTimeDescription(t.id_beneficio),")")}}function P(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2).$implicit;return e.\u0275\u0275resetView(o.editar=!0)}),e.\u0275\u0275text(1,"Editar"),e.\u0275\u0275elementEnd()}}function S(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",16),e.\u0275\u0275listener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const m=e.\u0275\u0275nextContext(2).$implicit;return e.\u0275\u0275resetView(m.tiempo=o)}),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275property("ngModel",t.tiempo)}}function E(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2).$implicit,m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.changeTime(o))}),e.\u0275\u0275text(1,"Guardar"),e.\u0275\u0275elementEnd()}}function T(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,F,2,2,"span",10),e.\u0275\u0275template(2,P,2,0,"a",11),e.\u0275\u0275template(3,S,1,1,"input",12),e.\u0275\u0275template(4,E,2,0,"button",13),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.editar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.editar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editar)}}function B(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",7)(2,"nb-checkbox",8),e.\u0275\u0275listener("checkedChange",function(o){const u=e.\u0275\u0275restoreView(t).$implicit,h=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(h.addOrRemoveBenefit(o,u.id_beneficio))}),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,T,5,4,"ng-container",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=r.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275property("checked","A"===t.estado),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","A"===t.estado)}}let w=(()=>{class i{constructor(t,n,o){this._placeService=t,this._toastrService=n,this._dialogService=o,this.onlyPermissions=!1,this.isLoading=!1,this.benefitList=[],this.selectedBenefits=[]}ngOnInit(){this.getBenefits()}getBenefits(){this.isLoading=!0,this._placeService.getBenefits({id_lugar:this.placeId}).subscribe({next:n=>{this.benefitList=n,this.benefitList.map(o=>{if("A"==o.estado){const{id_beneficio:m,tiempo:u}=o;this.selectedBenefits.push({id_beneficio:m,tiempo:u})}}),this.isLoading=!1}})}getTimeDescription(t){return 2==t||11==t||13==t?"horas":"d\xedas"}addOrRemoveBenefit(t,n){const o=t?"A":"I";this.benefitList=this.benefitList.map(m=>{if(m.id_beneficio==n){if(t){const{id_beneficio:u,tiempo:h}=m;this.selectedBenefits.push({id_beneficio:u,tiempo:h})}else this.selectedBenefits=this.selectedBenefits.filter(u=>u.id_beneficio!=n);m.estado=o}return m})}changeTime(t){t.editar=!1,this.selectedBenefits=this.selectedBenefits.map(n=>(n.id_beneficio==t.id_beneficio&&(n.tiempo=t.tiempo),n))}updateBenefits(){this._placeService.updateBenefits({id_lugar:this.placeId,lista:this.selectedBenefits,usuario_modificacion:"admin"}).subscribe({next:()=>{this.onlyPermissions?this._dialogService.close(!0):this.showToast("success","Beneficios actualizados")},error:()=>{this.showToast("danger","Error al actualizar")}})}showToast(t,n){this._toastrService.show("",n,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:l.fe3.TOP_RIGHT,preventDuplicates:!0})}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(c.k),e.\u0275\u0275directiveInject(l.quB),e.\u0275\u0275directiveInject(l.X4l))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-benefits"]],inputs:{placeId:"placeId",onlyPermissions:"onlyPermissions"},decls:12,vars:1,consts:[[1,"row","detail-container"],[1,"col-lg-12"],[1,"row"],[4,"ngFor","ngForOf"],[1,"row","pt-1"],[1,"col-12"],["nbButton","","status","info","hero","",3,"click"],[1,"col-6","py-1","d-flex","align-items-center"],[3,"checked","checkedChange"],[4,"ngIf"],["class","pl-2",4,"ngIf"],["class","cursor-pointer pl-2",3,"click",4,"ngIf"],["class","ml-2","type","number","nbInput","","fullWidth","","fieldSize","small","placeholder","Tiempo",3,"ngModel","ngModelChange",4,"ngIf"],["nbButton","","size","small","class","ml-2",3,"click",4,"ngIf"],[1,"pl-2"],[1,"cursor-pointer","pl-2",3,"click"],["type","number","nbInput","","fullWidth","","fieldSize","small","placeholder","Tiempo",1,"ml-2",3,"ngModel","ngModelChange"],["nbButton","","size","small",1,"ml-2",3,"click"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header"),e.\u0275\u0275text(4,"Seleccionar beneficios"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"nb-card-body")(6,"div",2),e.\u0275\u0275template(7,B,5,3,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",4)(9,"div",5)(10,"button",6),e.\u0275\u0275listener("click",function(){return n.updateBenefits()}),e.\u0275\u0275text(11,"Actualizar"),e.\u0275\u0275elementEnd()()()()()()()),2&t&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",n.benefitList))},dependencies:[C.sg,C.O5,p.Fj,p.wV,p.JJ,p.On,l.Asz,l.yKW,l.ndF,l.DPz,l.h8i,l.NTf],styles:[".detail-container[_ngcontent-%COMP%]{width:1080px}"]}),i})();var M=s(7672),R=s(37556),V=s(5527),k=s(44949),A=s(97007),I=s(62774),D=s(20732);function O(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",43),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.save())}),e.\u0275\u0275text(1," Guardar "),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!t.placeForm.valid)}}function L(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_tipo),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function d(i,r){if(1&i&&e.\u0275\u0275element(0,"nb-user",45),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("onlyPicture",!0)("picture",t.placeImage)}}function f(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",46,47),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275reference(1),m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.loadFile(o.files))}),e.\u0275\u0275elementEnd()}}function a(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",48),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.uploadImage())}),e.\u0275\u0275text(1,"Actualizar imagen"),e.\u0275\u0275elementEnd()}}function g(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function _(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,g,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("nombre").hasError("required"))}}function b(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function N(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,b,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("primario").hasError("required"))}}function W(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function $(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,W,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("secundario").hasError("required"))}}function G(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function U(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,G,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("dominio").hasError("required"))}}function J(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",51),e.\u0275\u0275element(2,"input",52),e.\u0275\u0275template(3,U,2,1,"ng-container",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.placeForm.get("dominio").invalid&&t.placeForm.get("dominio").touched)}}function K(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0)(1,"div",5)(2,"div",6)(3,"button",53),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.showBenefits())}),e.\u0275\u0275text(4,"Seleccionar beneficios"),e.\u0275\u0275elementEnd()()()()}}function Z(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_pais),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function H(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_provincia),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function X(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_ciudad),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function Y(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function Q(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Y,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("id_ciudad").hasError("required"))}}function q(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function ee(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,q,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("latitud").hasError("required"))}}function te(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function ne(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,te,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("longitud").hasError("required"))}}function ie(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",54)(1,"ngx-map",55),e.\u0275\u0275listener("mapClicked",function(o){e.\u0275\u0275restoreView(t);const m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.onMapClicked(o))}),e.\u0275\u0275elementEnd()()}if(2&i){const t=r.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("latitude",t.latitude)("longitude",t.longitude)("address",t.address)}}const j=function(){return{standalone:!0}};let oe=(()=>{class i{constructor(t,n,o,m,u,h,re,ae,le,ce){this._formBuilder=t,this._activatedRoute=n,this._dialogService=o,this._authService=m,this._placeService=u,this._toastrService=h,this._countryService=re,this._provinceService=ae,this._cityService=le,this._cdRef=ce,this.showUploadButton=!1,this.types=[],this.countries=[],this.provinces=[],this.cities=[],this.showDomain=!1,this.isAdmin=this._authService.isAdmin(),this._activatedRoute.params.subscribe(se=>{this.placeId=se.placeId}),this.initForm(),this.getTypes(),this.getCountries()}ngOnInit(){this.placeId?(this.getPlace(),this.action="Editar"):this.action="Crear"}initForm(){this.placeForm=this._formBuilder.group({id_tipo:["",p.kI.required],id_ciudad:["",p.kI.required],nombre:["",p.kI.required],descripcion:["",p.kI.required],latitud:["",p.kI.required],longitud:["",p.kI.required],imagen:["",p.kI.required],primario:["",p.kI.required],secundario:["",p.kI.required],dominio:[""],usuario_creacion:["admin",p.kI.required]})}getPlace(){var n,t=this;this._placeService.getPlace({id_lugar:this.placeId}).subscribe({next:(n=(0,v.Z)(function*(o){t.placeForm.patchValue(o),t.placeImage=`${y.N.storageUrl}/Lugar/${o.imagen}`,t.selectedCountry=o.id_pais,yield t.getProvinces(t.selectedCountry),t.selectedProvince=o.id_provincia,yield t.getCities(t.selectedProvince),t.selectedCity=o.id_ciudad,t.placeForm.get("dominio").value&&(t.showDomain=!0,t.placeForm.controls.dominio.setValidators(p.kI.required)),t._cdRef.detectChanges()}),function(m){return n.apply(this,arguments)}),error:n=>{console.error(n)}})}getTypes(){this._placeService.getTypes({id_usuario:"1"}).subscribe({next:t=>{this.types=t,this.selectType(this.types[0].id_tipo)},error:t=>{console.error(t)}})}getCountries(){this._countryService.getAll({id_usuario:"1"}).subscribe({next:t=>{this.countries=t.filter(n=>"A"===n.estado)},error:t=>{console.error(t)}})}getProvinces(t){var n=this;return(0,v.Z)(function*(){return new Promise(o=>{n._provinceService.getByCountry({id_usuario:"1",id_pais:t}).subscribe({next:u=>{n.provinces=u.filter(h=>"A"===h.estado),setTimeout(()=>o(),0)}})})})()}getCities(t){var n=this;return(0,v.Z)(function*(){return new Promise(o=>{n._cityService.getByProvince({id_usuario:"1",id_provincia:t}).subscribe({next:u=>{n.cities=u.filter(h=>"A"===h.estado),setTimeout(()=>o(),0)}})})})()}onMapClicked(t){this.placeForm.patchValue({latitud:t.latitud,longitud:t.longitud}),this.mapModal.close()}getAddressItem(t,n){return t.filter(o=>o.type==n)[0].description}showMap(t){this.mapModal=this._dialogService.open(t,{context:{latitude:this.placeForm.get("latitud").value,longitude:this.placeForm.get("longitud").value,address:this.getAddress()}})}getAddress(){let t="";return this.countries.map(n=>{n.id_pais==this.selectedCountry&&(t+=n.nombre+" ")}),this.provinces.map(n=>{n.id_provincia==this.selectedProvince&&(t+=n.nombre+" ")}),this.cities.map(n=>{n.id_ciudad==this.placeForm.get("id_ciudad").value&&(t+=n.nombre+" ")}),t}loadFile(t){if(!t.length)return;const n=t[0],o=new FileReader;o.onload=()=>{this.placeForm.patchValue({imagen:n}),this.placeImage=o.result,this.placeId&&(this.showUploadButton=!0),this._cdRef.detectChanges()},o.readAsDataURL(n)}uploadImage(){const t=new FormData;t.append("imagen",this.placeForm.value.imagen),t.append("id_lugar",this.placeId),t.append("usuario_modificacion","admin"),this._placeService.updateImage(t).subscribe({next:n=>{this.showToast("success","Imagen actualizada"),this.showUploadButton=!1,this._cdRef.detectChanges()},error:n=>{this.showToast("danger","Error al subir la imagen")}})}save(){const t=new FormData;Object.keys(this.placeForm.value).forEach(n=>{"dominio"==n&&!this.showDomain&&this.placeForm.get(n).setValue(""),("imagen"!==n||!this.placeId)&&t.append(n,this.placeForm.value[n])}),this.placeId?this.update(this.placeForm.value):this.create(t)}create(t){this._placeService.create(t).subscribe({next:()=>{this.showToast("success","Lugar creado")}})}update(t){const{usuario_creacion:n,imagen:o,...m}=t,u={...m,id_lugar:this.placeId,usuario_modificacion:"admin"};this._placeService.update(u).subscribe({next:()=>{this.showToast("success","Lugar actualizado")}})}showToast(t,n){this._toastrService.show("",n,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:l.fe3.TOP_RIGHT,preventDuplicates:!0})}onCountryChange(t){var n=this;return(0,v.Z)(function*(){n.selectedProvince=null,n.onProvinceChange(null),yield n.getProvinces(t)})()}onProvinceChange(t){var n=this;this.selectedCity=null,setTimeout((0,v.Z)(function*(){n.cities=null,n.selectCity(null),t&&(yield n.getCities(t))}),0)}selectType(t){this.placeForm.patchValue({id_tipo:t})}selectCity(t){this.placeForm.patchValue({id_ciudad:t})}toggleDomain(){this.showDomain?this.placeForm.controls.dominio.setValidators(p.kI.required):(this.placeForm.controls.dominio.removeValidators(p.kI.required),this.placeForm.controls.dominio.setErrors(null)),setTimeout(()=>{this._cdRef.detectChanges()},0)}showBenefits(){this._dialogService.open(w,{context:{placeId:this.placeId}})}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(p.qu),e.\u0275\u0275directiveInject(M.gz),e.\u0275\u0275directiveInject(l.Gln),e.\u0275\u0275directiveInject(R.e),e.\u0275\u0275directiveInject(c.k),e.\u0275\u0275directiveInject(l.quB),e.\u0275\u0275directiveInject(V.T),e.\u0275\u0275directiveInject(k.f),e.\u0275\u0275directiveInject(A.Z),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-place-form"]],decls:104,vars:29,consts:[[1,"row"],[1,"col-lg-12"],[1,"w-100","d-flex","justify-content-between"],["nbButton","","status","info","hero","",3,"disabled","click",4,"ngIf"],[3,"formGroup"],[1,"col-sm-4"],[1,"form-group"],["for","inputTipo",1,"label"],["fullWidth","","id","inputTipo","formControlName","id_tipo","placeholder","Seleccionar una opci\xf3n",3,"selected"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-8"],["for","inputImagen",1,"label"],[1,"d-flex","align-items-center"],[3,"onlyPicture","picture",4,"ngIf"],["id","inputImagen","class","pl-2","type","file","fullWidth","",3,"change",4,"ngIf"],["nbButton","","ghost","","status","info",3,"click",4,"ngIf"],["for","inputNombre",1,"label"],["id","inputNombre","type","text","nbInput","","fullWidth","","placeholder","Nombre","formControlName","nombre"],[4,"ngIf"],["for","inputDescripcion",1,"label"],["id","inputDescripcion","type","text","nbInput","","fullWidth","","placeholder","Descripci\xf3n","formControlName","descripcion"],["for","inputPrimario",1,"label"],["id","inputPrimario","type","text","nbInput","","fullWidth","","placeholder","Primario","formControlName","primario"],["for","inputSecundario",1,"label"],["id","inputSecundario","type","text","nbInput","","fullWidth","","placeholder","Secundario","formControlName","secundario"],["for","inputDominio",1,"label"],[1,"d-flex","align-items-start"],["status","success",3,"checked","checkedChange"],["class","row",4,"ngIf"],[1,"mt-4"],["for","inputPais",1,"label"],["fullWidth","","id","inputPais","placeholder","Seleccione una opci\xf3n","required","",3,"ngModel","ngModelOptions","selectedChange","ngModelChange"],["for","inputProvincia",1,"label"],["fullWidth","","id","inputProvincia","placeholder","Seleccione una opci\xf3n",3,"ngModel","ngModelOptions","selectedChange","ngModelChange"],["for","inputCiudad",1,"label"],["fullWidth","","id","inputCiudad","placeholder","Seleccione una opci\xf3n",3,"ngModel","ngModelOptions","selectedChange","ngModelChange"],["for","inputLatitud",1,"label"],["id","inputLatitud","type","text","nbInput","","fullWidth","","placeholder","Latitud","formControlName","latitud"],["for","inputLongitud",1,"label"],["id","inputLongitud","type","text","nbInput","","fullWidth","","placeholder","Longitud","formControlName","longitud"],[1,"form-group","mb-0","mt-4"],["nbButton","","status","info","ghost","",3,"click"],["map",""],["nbButton","","status","info","hero","",3,"disabled","click"],[3,"value"],[3,"onlyPicture","picture"],["id","inputImagen","type","file","fullWidth","",1,"pl-2",3,"change"],["fileControl",""],["nbButton","","ghost","","status","info",3,"click"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"],[1,"ml-2"],["id","inputDominio","type","text","nbInput","","fullWidth","","placeholder","Dominio","formControlName","dominio"],["nbButton","",3,"click"],[1,"map-container"],[3,"latitude","longitude","address","mapClicked"]],template:function(t,n){if(1&t){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ngx-no-padding-layout")(1,"div",0)(2,"div",1)(3,"nb-card")(4,"nb-card-header",2)(5,"h5"),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div"),e.\u0275\u0275template(8,O,2,1,"button",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"nb-card-body")(10,"form",4)(11,"fieldset")(12,"legend"),e.\u0275\u0275text(13,"Informaci\xf3n del lugar"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",0)(15,"div",5)(16,"div",6)(17,"label",7),e.\u0275\u0275text(18,"Tipo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"nb-select",8),e.\u0275\u0275template(20,L,2,2,"nb-option",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(21,"div",10)(22,"div",6)(23,"label",11),e.\u0275\u0275text(24,"Imagen"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"div",12),e.\u0275\u0275template(26,d,1,2,"nb-user",13),e.\u0275\u0275template(27,f,2,0,"input",14),e.\u0275\u0275template(28,a,2,0,"button",15),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(29,"div",0)(30,"div",5)(31,"div",6)(32,"label",16),e.\u0275\u0275text(33,"Nombre"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",17),e.\u0275\u0275template(35,_,2,1,"ng-container",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(36,"div",10)(37,"div",6)(38,"label",19),e.\u0275\u0275text(39,"Descripci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(40,"input",20),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(41,"div",0)(42,"div",5)(43,"div",6)(44,"label",21),e.\u0275\u0275text(45,"Primario"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(46,"input",22),e.\u0275\u0275template(47,N,2,1,"ng-container",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(48,"div",5)(49,"div",6)(50,"label",23),e.\u0275\u0275text(51,"Secundario"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(52,"input",24),e.\u0275\u0275template(53,$,2,1,"ng-container",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(54,"div",5)(55,"div",6)(56,"label",25),e.\u0275\u0275text(57,"Dominio"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"div",26)(59,"nb-toggle",27),e.\u0275\u0275listener("checkedChange",function(u){return n.showDomain=u})("checkedChange",function(){return n.toggleDomain()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(60,J,4,1,"ng-container",18),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(61,K,5,0,"div",28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"fieldset",29)(63,"legend"),e.\u0275\u0275text(64,"Ubicaci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(65,"div",0)(66,"div",5)(67,"div",6)(68,"label",30),e.\u0275\u0275text(69,"Pa\xeds"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(70,"nb-select",31),e.\u0275\u0275listener("selectedChange",function(u){return n.onCountryChange(u)})("ngModelChange",function(u){return n.selectedCountry=u}),e.\u0275\u0275template(71,Z,2,2,"nb-option",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(72,"div",5)(73,"div",6)(74,"label",32),e.\u0275\u0275text(75,"Provincia"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(76,"nb-select",33),e.\u0275\u0275listener("selectedChange",function(u){return n.onProvinceChange(u)})("ngModelChange",function(u){return n.selectedProvince=u}),e.\u0275\u0275template(77,H,2,2,"nb-option",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(78,"div",5)(79,"div",6)(80,"label",34),e.\u0275\u0275text(81,"Ciudad"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(82,"nb-select",35),e.\u0275\u0275listener("selectedChange",function(u){return n.selectCity(u)})("ngModelChange",function(u){return n.selectedCity=u}),e.\u0275\u0275template(83,X,2,2,"nb-option",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(84,Q,2,1,"ng-container",18),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(85,"div",0)(86,"div",5)(87,"div",6)(88,"label",36),e.\u0275\u0275text(89,"Latitud"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(90,"input",37),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(91,ee,2,1,"ng-container",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(92,"div",5)(93,"div",6)(94,"label",38),e.\u0275\u0275text(95,"Longitud"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(96,"input",39),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(97,ne,2,1,"ng-container",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(98,"div",5)(99,"div",40)(100,"button",41),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const u=e.\u0275\u0275reference(103);return e.\u0275\u0275resetView(n.showMap(u))}),e.\u0275\u0275text(101,"Ver mapa"),e.\u0275\u0275elementEnd()()()()()()()()()()(),e.\u0275\u0275template(102,ie,2,3,"ng-template",null,42,e.\u0275\u0275templateRefExtractor)}2&t&&(e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1("",n.action," Lugar"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.isAdmin),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",n.placeForm),e.\u0275\u0275advance(9),e.\u0275\u0275property("selected",null==n.types[0]?null:n.types[0].id_tipo),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.types),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.placeImage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isAdmin),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showUploadButton),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.placeForm.get("nombre").invalid&&n.placeForm.get("nombre").touched),e.\u0275\u0275advance(12),e.\u0275\u0275property("ngIf",n.placeForm.get("primario").invalid&&n.placeForm.get("primario").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.placeForm.get("secundario").invalid&&n.placeForm.get("secundario").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("checked",n.showDomain),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showDomain),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isAdmin&&"Editar"===n.action),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngModel",n.selectedCountry)("ngModelOptions",e.\u0275\u0275pureFunction0(26,j)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.countries),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",n.selectedProvince)("ngModelOptions",e.\u0275\u0275pureFunction0(27,j)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.provinces),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",n.selectedCity)("ngModelOptions",e.\u0275\u0275pureFunction0(28,j)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.cities),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.placeForm.get("id_ciudad").invalid&&n.placeForm.get("id_ciudad").touched),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.placeForm.get("latitud").invalid&&n.placeForm.get("latitud").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.placeForm.get("longitud").invalid&&n.placeForm.get("longitud").touched))},dependencies:[C.sg,C.O5,I.G,D.F,p._Y,p.Fj,p.JJ,p.JL,p.Q7,p.On,p.sg,p.u,l.Asz,l.yKW,l.ndF,l.DPz,l.h8i,l.rs,l.q51,l.k0$,l.BLq],styles:[".map-container[_ngcontent-%COMP%]{padding:20px;background-color:#fff}nb-card[_ngcontent-%COMP%]{border-radius:0;border-top:0}"],changeDetection:0}),i})()},85099:(z,x,s)=>{s.r(x),s.d(x,{PlacesModule:()=>L});var v=s(97137),p=s(7672),l=s(36517),y=s(74385),e=s(36749),c=s(94650),C=s(37556),F=s(12368),P=s(36895),S=s(20732);function E(d,f){if(1&d){const a=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",4),c.\u0275\u0275listener("click",function(){c.\u0275\u0275restoreView(a);const _=c.\u0275\u0275nextContext();return c.\u0275\u0275resetView(_.add())}),c.\u0275\u0275text(1," Nuevo "),c.\u0275\u0275elementEnd()}}let T=(()=>{class d{constructor(a,g,_,b){this.router=a,this._authService=g,this._placeService=_,this._toastrService=b,this.settings={actions:{position:"right",add:!1,edit:!1,delete:!1,custom:[{name:"edit",title:'<i class="nb-edit"></i>'}]},columns:{nombre:{title:"Nombre",type:"string"},tipo:{title:"Tipo",type:"string"},descripcion:{title:"Descripcion",type:"string"}}},this.source=new y.nC,this.isAdmin=this._authService.isAdmin(),this.setAdminColumns()}ngOnInit(){this.getPlaces()}setAdminColumns(){this.isAdmin&&(this.settings.columns.estado={title:"Estado",type:"custom",renderComponent:e.P,onComponentInitFunction:a=>{a.toggle.subscribe(g=>{this.updateStatus(g.row.id_lugar,g.value?"A":"I")})}})}getPlaces(){this._placeService.getPlaces({id_usuario:"1"}).subscribe({next:a=>{const g=a.filter(_=>"E"!=_.estado);this.source.load(g)},error:a=>{console.error(a)}})}onDeleteConfirm(a){window.confirm("Are you sure you want to delete?")?a.confirm.resolve():a.confirm.reject()}onCustom(a){"edit"===a.action&&(this._placeService.setPlace(a.data),this.router.navigate([`/pages/lugares/${a.data.id_lugar}`]))}add(){this.router.navigate(["/pages/lugares/crear"])}updateStatus(a,g){this._placeService.updateStatus({id_lugar:a,estado:g,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Estado de lugar actualizado")},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}showToast(a,g){this._toastrService.show("",g,{status:a,destroyByClick:!0,duration:3e3,hasIcon:!1,position:l.fe3.TOP_RIGHT,preventDuplicates:!0})}}return d.\u0275fac=function(a){return new(a||d)(c.\u0275\u0275directiveInject(p.F0),c.\u0275\u0275directiveInject(C.e),c.\u0275\u0275directiveInject(F.k),c.\u0275\u0275directiveInject(l.quB))},d.\u0275cmp=c.\u0275\u0275defineComponent({type:d,selectors:[["ngx-places-list"]],decls:9,vars:3,consts:[[1,"w-100","d-flex","justify-content-between"],[1,""],["nbButton","","status","info","hero","",3,"click",4,"ngIf"],[1,"custom-table",3,"settings","source","custom","deleteConfirm"],["nbButton","","status","info","hero","",3,"click"]],template:function(a,g){1&a&&(c.\u0275\u0275elementStart(0,"ngx-no-padding-layout")(1,"nb-card")(2,"nb-card-header",0)(3,"h5"),c.\u0275\u0275text(4,"Lugares"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(5,"div",1),c.\u0275\u0275template(6,E,2,0,"button",2),c.\u0275\u0275elementEnd()(),c.\u0275\u0275elementStart(7,"nb-card-body")(8,"ng2-smart-table",3),c.\u0275\u0275listener("custom",function(b){return g.onCustom(b)})("deleteConfirm",function(b){return g.onDeleteConfirm(b)}),c.\u0275\u0275elementEnd()()()()),2&a&&(c.\u0275\u0275advance(6),c.\u0275\u0275property("ngIf",g.isAdmin),c.\u0275\u0275advance(2),c.\u0275\u0275property("settings",g.settings)("source",g.source))},dependencies:[P.O5,S.F,l.Asz,l.yKW,l.ndF,y.T5,l.DPz],styles:["[_nghost-%COMP%]     tr .ng2-smart-actions{height:auto}[_nghost-%COMP%]     ng2-st-tbody-custom{display:flex}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom{display:inline-block;text-align:center}"]}),d})(),B=(()=>{class d{constructor(a){this._authService=a,this.isAdmin=!1,this.isAdmin=this._authService.isAdmin()}}return d.\u0275fac=function(a){return new(a||d)(c.\u0275\u0275directiveInject(C.e))},d.\u0275cmp=c.\u0275\u0275defineComponent({type:d,selectors:[["ngx-places"]],decls:1,vars:0,template:function(a,g){1&a&&c.\u0275\u0275element(0,"router-outlet")},dependencies:[p.lC],encapsulation:2}),d})();var w=s(76546),M=s(14019);const V=[{path:"",component:B,children:[{path:"",component:T},{path:"crear",component:(()=>{class d{constructor(){}}return d.\u0275fac=function(a){return new(a||d)},d.\u0275cmp=c.\u0275\u0275defineComponent({type:d,selectors:[["ngx-place-create"]],decls:2,vars:0,template:function(a,g){1&a&&(c.\u0275\u0275elementStart(0,"ngx-simple-content-layout"),c.\u0275\u0275element(1,"ngx-place-form"),c.\u0275\u0275elementEnd())},dependencies:[w.R,M.C]}),d})()},{path:":placeId",loadChildren:()=>s.e(609).then(s.bind(s,34609)).then(d=>d.PlaceDetailModule)}]}];let k=(()=>{class d{}return d.\u0275fac=function(a){return new(a||d)},d.\u0275mod=c.\u0275\u0275defineNgModule({type:d}),d.\u0275inj=c.\u0275\u0275defineInjector({imports:[p.Bz.forChild(V),p.Bz]}),d})();var A=s(92661),I=s(24006),D=s(39263),O=s(78253);let L=(()=>{class d{}return d.\u0275fac=function(a){return new(a||d)},d.\u0275mod=c.\u0275\u0275defineNgModule({type:d}),d.\u0275inj=c.\u0275\u0275defineInjector({imports:[v.O,I.u5,I.UX,k,l.zyh,y.ne,l.T2N,l.nKr,l.IIj,A.Y4,l.AE1,l.COg,l.KdK,l.EoG,l.j5J,l.obu,l.wB1,l.MfT,D.ResidentsModule,O.AccessReportModule]}),d})()}}]);