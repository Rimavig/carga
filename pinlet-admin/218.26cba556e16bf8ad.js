"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[218],{89218:(N,h,r)=>{r.r(h),r.d(h,{ProvincesModule:()=>j});var g=r(36895),u=r(7672),I=r(45096),e=r(30551),C=r(20732);let y=(()=>{class i{constructor(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-provinces"]],decls:2,vars:0,template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"ngx-no-padding-layout"),e.\u0275\u0275element(1,"router-outlet"),e.\u0275\u0275elementEnd())},dependencies:[C.F,u.lC],encapsulation:2}),i})();var c=r(24006),s=r(36517),p=r(99501),b=r(44949),v=r(74385),P=r(42658),S=r(36749),_=r(97007);let x=(()=>{class i{constructor(t,n,o,d){this._router=t,this._dialogService=n,this._toastrService=o,this._cityService=d,this.settings={actions:{position:"right",add:!1,edit:!1,delete:!1,custom:[{name:"edit",title:'<i class="nb-edit"></i>'},{name:"delete",title:'<i class="nb-trash"></i>'}]},columns:{nombre:{title:"Nombre",type:"string"},estado:{title:"Estado",type:"custom",renderComponent:S.P,onComponentInitFunction:m=>{m.toggle.subscribe(l=>{this.updateStatus(l.row.id_ciudad,l.value?"A":"I")})}}},noDataMessage:"No existen registros"},this.source=new v.nC}ngOnChanges(t){t.provinceId?.currentValue&&(this.provinceId=t.provinceId?.currentValue,this.getCities(this.provinceId))}getCities(t){this._cityService.getByProvince({id_usuario:"1",id_provincia:t}).subscribe({next:o=>{const d=o.filter(m=>"E"!=m.estado);this.source.load(d)},error:o=>{console.error(o)}})}onCustom(t){switch(t.action){case"edit":this._router.navigateByUrl(`/pages/ciudades/editar/${t.data.id_ciudad}?idProvincia=${this.provinceId}`);break;case"delete":this.onDelete(t.data.id_ciudad)}}onDelete(t){this._dialogService.open(P.S,{context:{title:"\xbfEst\xe1 seguro de eliminar el registro?"}}).onClose.subscribe({next:n=>{n&&this.deleteCity(t)}})}updateStatus(t,n){this._cityService.updateStatus({id_ciudad:t,estado:n,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Estado de ciudad actualizado")},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}deleteCity(t){this._cityService.delete({id_ciudad:t,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Ciudad eliminada"),this.getCities(this.provinceId)},error:()=>{this.showToast("danger","Error al eliminar la ciudad")}})}showToast(t,n){this._toastrService.show("",n,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(u.F0),e.\u0275\u0275directiveInject(s.Gln),e.\u0275\u0275directiveInject(s.quB),e.\u0275\u0275directiveInject(_.Z))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-cities-list"]],inputs:{provinceId:"provinceId"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:2,consts:[[1,"custom-table",3,"settings","source","custom"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"ng2-smart-table",0),e.\u0275\u0275listener("custom",function(d){return n.onCustom(d)}),e.\u0275\u0275elementEnd()),2&t&&e.\u0275\u0275property("settings",n.settings)("source",n.source)},dependencies:[v.T5],styles:["[_nghost-%COMP%]     tr .ng2-smart-actions{height:auto}[_nghost-%COMP%]     ng2-st-tbody-custom{display:flex}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom{display:inline-block;text-align:center}"]}),i})();function F(i,a){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13)(2,"h6"),e.\u0275\u0275text(3,"Ciudades"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",14)(5,"button",6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.add())}),e.\u0275\u0275text(6," Nuevo "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(7,"ngx-cities-list",15),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(7),e.\u0275\u0275property("provinceId",t.provinceId)}}let f=(()=>{class i{constructor(t,n,o,d,m){this._router=t,this._formBuilder=n,this._activatedRoute=o,this._provinceService=d,this._toastrService=m,this.cities=[],this.statusOptions=[{key:"Activo",value:p.q.ACTIVO},{key:"Inactivo",value:p.q.INACTIVO},{key:"Pendiente",value:p.q.PENDIENTE}],this._activatedRoute.params.subscribe(l=>{this.provinceId=l.id}),this._activatedRoute.queryParams.subscribe(l=>{this.countryId=l.idPais}),this.initForm()}ngOnInit(){this.provinceId?(this.getProvince(),this.action="Editar"):this.action="Crear"}initForm(){this.provinceForm=this._formBuilder.group({id_pais:[this.countryId,c.kI.required],nombre:["",c.kI.required],estado:[""],usuario_creacion:["admin",c.kI.required]})}getProvince(){this._provinceService.getById({id_provincia:this.provinceId}).subscribe({next:t=>{this.provinceForm.patchValue(t),this.countryId=this.provinceForm.get("id_pais").value,this.selectedStatus=t.estado},error:t=>{console.error(t)}})}save(){this.provinceId?this.update():this.create()}create(){this._provinceService.create(this.provinceForm.value).subscribe({next:()=>{this.showToast("success","Provincia creada"),this.goBack()},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}update(){this._provinceService.update({id_provincia:this.provinceId,id_pais:this.provinceForm.value.id_pais,nombre:this.provinceForm.value.nombre,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Provincia actualizada")},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}changeStatus(t){t!==this.selectedStatus&&(this.selectedStatus=t,this._provinceService.updateStatus({id_provincia:this.provinceId,estado:t,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","\xa1Se ha cambiado el estado!")},error:()=>{this.showToast("danger","\xa1No se ha podido cambiar el estado!")}}))}showToast(t,n){this._toastrService.show("",n,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}add(){this._router.navigateByUrl(`/pages/ciudades/crear?idProvincia=${this.provinceId}`)}goBack(){this._router.navigate([`/pages/paises/editar/${this.countryId}`])}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(u.F0),e.\u0275\u0275directiveInject(c.qu),e.\u0275\u0275directiveInject(u.gz),e.\u0275\u0275directiveInject(b.f),e.\u0275\u0275directiveInject(s.quB))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-province-form"]],decls:21,vars:3,consts:[[1,"row"],[1,"col-lg-12"],[1,"w-100","d-flex","justify-content-between"],[1,"d-flex","align-items-center","h5"],[1,"d-flex","cursor-pointer","no-hover","pr-2",3,"click"],[1,"custom-icon","nb-arrow-left"],["nbButton","","status","info","hero","",3,"click"],[3,"formGroup"],[1,"col-sm-4"],[1,"form-group"],["for","inputNombre",1,"label"],["type","text","nbInput","","fullWidth","","id","inputNombre","placeholder","Nombre","formControlName","nombre"],[4,"ngIf"],[1,"w-100","d-flex","justify-content-between","py-3"],[1,""],[3,"provinceId"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header",2)(4,"div",3)(5,"a",4),e.\u0275\u0275listener("click",function(){return n.goBack()}),e.\u0275\u0275element(6,"i",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"h5"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"div")(10,"button",6),e.\u0275\u0275listener("click",function(){return n.save()}),e.\u0275\u0275text(11," Guardar "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(12,"nb-card-body")(13,"form",7)(14,"div",0)(15,"div",8)(16,"div",9)(17,"label",10),e.\u0275\u0275text(18,"Nombre"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(19,"input",11),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(20,F,8,1,"ng-container",12),e.\u0275\u0275elementEnd()()()()),2&t&&(e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate1("",n.action," Provincia"),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",n.provinceForm),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.provinceId))},dependencies:[g.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,s.Asz,s.yKW,s.ndF,s.h8i,s.DPz,x]}),i})();const T=[{path:"",component:y,children:[{path:"",component:I.X},{path:"crear",component:f},{path:"editar/:id",component:f}]}];let E=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.Bz.forChild(T),u.Bz]}),i})();var w=r(27074);let j=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[g.ez,w.O,c.UX,E,v.ne,s.zyh,s.nKr,s.T2N,s.IIj]}),i})()}}]);