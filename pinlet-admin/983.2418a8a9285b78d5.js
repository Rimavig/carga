"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[983],{91983:(z,f,a)=>{a.r(f),a.d(f,{LocationRegistersModule:()=>B});var R=a(97137),r=a(24006),d=a(7672),e=a(94650);let I=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["ngx-location-registers"]],decls:1,vars:0,template:function(t,i){1&t&&e.\u0275\u0275element(0,"router-outlet")},dependencies:[d.lC],encapsulation:2}),n})();var L=a(36749),p=a(74385),s=a(36517),C=a(15861),_=a(92340),b=a(80529);let v=(()=>{class n{constructor(t){this.http=t,this.apiUrl=_.N.apiUrl}getAll(t){return this.http.post(`${this.apiUrl}/getAllMarcacion_lugar`,t)}getById(t){return this.http.post(`${this.apiUrl}/getMarcacion`,t)}create(t){return this.http.post(`${this.apiUrl}/insertMarcacion`,t)}update(t){return this.http.post(`${this.apiUrl}/updateMarcacion`,t)}delete(t){return this.http.post(`${this.apiUrl}/deleteMarcacion`,t)}updateStatus(t){return this.http.post(`${this.apiUrl}/updateEstadoMarcacion`,t)}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275inject(b.eN))},n.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var y=a(12368),S=a(36895);function x(n,o){1&n&&(e.\u0275\u0275elementStart(0,"p",16),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function E(n,o){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,x,2,0,"p",15),e.\u0275\u0275elementContainerEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.locationRegisterForm.get("direccion").hasError("required"))}}function F(n,o){1&n&&(e.\u0275\u0275elementStart(0,"p",16),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function T(n,o){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,F,2,0,"p",15),e.\u0275\u0275elementContainerEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.locationRegisterForm.get("descripcion").hasError("required"))}}let m=(()=>{class n{constructor(t,i,c,l,g,u){this._formBuilder=t,this._activatedRoute=i,this._locationRegisterService=c,this._placeService=l,this._toastrService=g,this._dialogRef=u,this.isLoading=!1,this._activatedRoute.params.subscribe(h=>{this.locationRegisterId=h.id}),this.initForm()}ngOnInit(){this.locationRegisterId?(this.getLocationRegister(),this.action="Editar"):(this.action="Crear",this.locationRegisterForm.patchValue({id_lugar:this.placeId}))}initForm(){this.locationRegisterForm=this._formBuilder.group({id_lugar:["",r.kI.required],id_residente_lugar:["",r.kI.required],latitud:["",r.kI.required],longitud:["",r.kI.required],direccion:["",r.kI.required],tipo_acceso:["",r.kI.required],descripcion:["",r.kI.required],usuario_creacion:["admin",r.kI.required]})}getLocationRegister(){var i,t=this;this._locationRegisterService.getById({id_marcacion_residente:this.locationRegisterId}).subscribe({next:(i=(0,C.Z)(function*(c){t.locationRegisterForm.patchValue(c),t.locationRegister=c}),function(l){return i.apply(this,arguments)}),error:i=>{console.error(i)}})}save(){this.isLoading=!0;const t=this.locationRegisterForm.value;this.locationRegisterId?(t.id_marcacion_residente=this.locationRegisterId,t.usuario_modificacion="admin",this.update(t)):(t.usuario_creacion="admin",this.create(t))}create(t){this._locationRegisterService.create(t).subscribe({next:()=>{this.isLoading=!1,this.showToast("success","Registro creado"),this._dialogRef.close(!0)},error:()=>{this.isLoading=!1,this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}update(t){this._locationRegisterService.update(t).subscribe({next:()=>{this.isLoading=!1,this.showToast("success","Registro actualizado"),this._dialogRef.close(!0)},error:()=>{this.isLoading=!1,this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}showToast(t,i){this._toastrService.show("",i,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(r.qu),e.\u0275\u0275directiveInject(d.gz),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(y.k),e.\u0275\u0275directiveInject(s.quB),e.\u0275\u0275directiveInject(s.X4l))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["ngx-location-register-form"]],decls:69,vars:11,consts:[[1,"w-100","d-flex","justify-content-between"],["nbButton","","status","info","hero","",3,"disabled","click"],[1,"container"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"form-group"],[1,"label"],["for","inputCedula",1,"label"],[1,"col-md-12"],["for","inputDireccion",1,"label"],["id","inputDireccion","nbInput","","fullWidth","","formControlName","direccion"],[4,"ngIf"],["for","inputDescripcion",1,"label"],["id","inputDescripcion","nbInput","","fullWidth","","formControlName","descripcion"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"nb-card")(1,"nb-card-header",0)(2,"h5"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div")(5,"button",1),e.\u0275\u0275listener("click",function(){return i.save()}),e.\u0275\u0275text(6," Guardar "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"nb-card-body")(8,"div",2)(9,"form",3)(10,"div",4)(11,"div",5)(12,"div",6)(13,"div",7),e.\u0275\u0275text(14,"Nombres"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"div")(16,"span"),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(18,"div",5)(19,"div",6)(20,"div",8),e.\u0275\u0275text(21,"Apellidos"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div")(23,"span"),e.\u0275\u0275text(24),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(25,"div",4)(26,"div",5)(27,"div",6)(28,"div",7),e.\u0275\u0275text(29,"Celular"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"div")(31,"span"),e.\u0275\u0275text(32),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(33,"div",5)(34,"div",6)(35,"div",8),e.\u0275\u0275text(36,"C\xe9dula"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"div")(38,"span"),e.\u0275\u0275text(39),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(40,"div",4)(41,"div",5)(42,"div",6)(43,"div",7),e.\u0275\u0275text(44,"Longitud"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"div")(46,"span"),e.\u0275\u0275text(47),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(48,"div",5)(49,"div",6)(50,"div",7),e.\u0275\u0275text(51,"Latitud"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"div")(53,"span"),e.\u0275\u0275text(54),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(55,"div",4)(56,"div",9)(57,"div",6)(58,"label",10),e.\u0275\u0275text(59,"Direcci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(60,"input",11),e.\u0275\u0275template(61,E,2,1,"ng-container",12),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(62,"div",4)(63,"div",9)(64,"div",6)(65,"label",13),e.\u0275\u0275text(66,"Descripci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(67,"textarea",14),e.\u0275\u0275template(68,T,2,1,"ng-container",12),e.\u0275\u0275elementEnd()()()()()()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",i.action," Marcaci\xf3n"),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",!i.locationRegisterForm.valid||i.isLoading),e.\u0275\u0275advance(4),e.\u0275\u0275property("formGroup",i.locationRegisterForm),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(null==i.locationRegister?null:i.locationRegister.nombres_residente),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(null==i.locationRegister?null:i.locationRegister.apellidos_residente),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(null==i.locationRegister?null:i.locationRegister.celular_residente),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(null==i.locationRegister?null:i.locationRegister.cedula_residente),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(null==i.locationRegister?null:i.locationRegister.longitud),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(null==i.locationRegister?null:i.locationRegister.latitud),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",i.locationRegisterForm.get("direccion").invalid&&i.locationRegisterForm.get("direccion").touched),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",i.locationRegisterForm.get("descripcion").invalid&&i.locationRegisterForm.get("descripcion").touched))},dependencies:[S.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,s.Asz,s.yKW,s.ndF,s.h8i,s.DPz]}),n})();var j=a(42658),M=a(20732);const w=[{path:"",component:I,children:[{path:"",component:(()=>{class n{constructor(t,i,c,l){this._locationRegisterService=t,this._activatedRoute=i,this._dialogService=c,this._toastrService=l,this.settings={actions:{position:"right",add:!1,edit:!1,delete:!1,custom:[{name:"edit",title:'<i class="nb-edit"></i>'},{name:"delete",title:'<i class="nb-trash"></i>'}]},columns:{nombres_residente:{title:"Nombres",type:"string",filter:!1},apellidos_residente:{title:"Apellidos",type:"string",filter:!1},cedula_residente:{title:"C\xe9dula",type:"string",filter:!1},celular_residente:{title:"Celular",type:"string",filter:!1},correo_residente:{title:"Correo residente",type:"string",filter:!1},primario_residente:{title:"Primario",type:"string",filter:!1},secundario_residente:{title:"Secundario",type:"string",filter:!1},longitud:{title:"Longitud",type:"string",filter:!1},latitud:{title:"Latitud",type:"string",filter:!1},direccion:{title:"Direcci\xf3n",type:"string",filter:!1},tipo_acceso:{title:"Tipo de acceso",type:"string",filter:!1},descripcion:{title:"Descripcion",type:"string",filter:!1},estado:{title:"Estado",type:"custom",filter:!1,renderComponent:L.P,onComponentInitFunction:g=>{g.toggle.subscribe(u=>{this.updateStatus(u.row.id_marcacion_residente,u.value?"A":"I")})}}}},this.source=new p.nC}ngOnInit(){this.placeId=parseInt(this._activatedRoute.parent.parent.parent.snapshot.paramMap.get("placeId")),this.getLocationRegisters()}getLocationRegisters(){this._locationRegisterService.getAll({id_lugar:this.placeId}).subscribe({next:t=>{this.locationRegisters=t,this.source.load(t)}})}onCustom(t){switch(t.action){case"edit":this.onEdit(t.data.id_marcacion_residente);break;case"delete":this.onDelete(t.data.id_marcacion_residente)}}add(){this._dialogService.open(m,{context:{placeId:this.placeId}}).onClose.subscribe({next:t=>{t&&this.getLocationRegisters()}})}onEdit(t){this._dialogService.open(m,{context:{placeId:this.placeId,locationRegisterId:t}}).onClose.subscribe({next:i=>{i&&this.getLocationRegisters()}})}onDelete(t){this._dialogService.open(j.S,{context:{title:"\xbfEst\xe1 seguro de borrar el registro?"}}).onClose.subscribe({next:i=>{i&&this.delete(t)}})}delete(t){this._locationRegisterService.delete({id_marcacion_residente:t,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Registro eliminado"),this.getLocationRegisters()},error:()=>{this.showToast("danger","Error al eliminar el registro")}})}updateStatus(t,i){this._locationRegisterService.updateStatus({id_marcacion_residente:t,estado:i,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Estado de registro actualizado")},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}showToast(t,i){this._toastrService.show("",i,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(d.gz),e.\u0275\u0275directiveInject(s.Gln),e.\u0275\u0275directiveInject(s.quB))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["ngx-location-registers-list"]],decls:7,vars:2,consts:[[1,"w-100","d-flex","justify-content-between"],[1,"custom-table",3,"settings","source","custom"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"ngx-no-padding-layout")(1,"nb-card")(2,"nb-card-header",0)(3,"h5"),e.\u0275\u0275text(4,"Marcaciones"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"nb-card-body")(6,"ng2-smart-table",1),e.\u0275\u0275listener("custom",function(l){return i.onCustom(l)}),e.\u0275\u0275elementEnd()()()()),2&t&&(e.\u0275\u0275advance(6),e.\u0275\u0275property("settings",i.settings)("source",i.source))},dependencies:[M.F,s.Asz,s.yKW,s.ndF,p.T5]}),n})()},{path:"crear",component:m}]}];let D=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[d.Bz.forChild(w),d.Bz]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[R.O,r.u5,r.UX,D,s.zyh,p.ne,s.nKr,s.T2N]}),n})()}}]);