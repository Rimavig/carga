"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[662],{14019:(A,y,c)=>{c.d(y,{C:()=>ne});var C=c(15861),d=c(24006),u=c(36517),g=c(92340),e=c(30551),I=c(12368),a=c(36895);function P(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"span",14),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("(",t.tiempo," d\xedas)")}}function S(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2).$implicit;return e.\u0275\u0275resetView(o.editar=!0)}),e.\u0275\u0275text(1,"Editar"),e.\u0275\u0275elementEnd()}}function E(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",16),e.\u0275\u0275listener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext(2).$implicit;return e.\u0275\u0275resetView(l.tiempo=o)}),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275property("ngModel",t.tiempo)}}function T(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changeTime(o))}),e.\u0275\u0275text(1,"Guardar"),e.\u0275\u0275elementEnd()}}function L(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,P,2,1,"span",10),e.\u0275\u0275template(2,S,2,0,"a",11),e.\u0275\u0275template(3,E,1,1,"input",12),e.\u0275\u0275template(4,T,2,0,"button",13),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.editar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.editar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editar)}}function j(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",7)(2,"nb-checkbox",8),e.\u0275\u0275listener("checkedChange",function(o){const p=e.\u0275\u0275restoreView(t).$implicit,v=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(v.addOrRemoveBenefit(o,p.id_beneficio))}),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,L,5,4,"ng-container",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=r.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275property("checked","A"===t.estado),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","A"===t.estado)}}let B=(()=>{class i{constructor(t,n,o){this._placeService=t,this._toastrService=n,this._dialogService=o,this.onlyPermissions=!1,this.isLoading=!1,this.benefitList=[],this.selectedBenefits=[]}ngOnInit(){this.getBenefits()}getBenefits(){this.isLoading=!0,this._placeService.getBenefits({id_lugar:this.placeId}).subscribe({next:n=>{this.benefitList=n,this.benefitList.map(o=>{if("A"==o.estado){const{id_beneficio:l,tiempo:p}=o;this.selectedBenefits.push({id_beneficio:l,tiempo:p})}}),this.isLoading=!1}})}addOrRemoveBenefit(t,n){const o=t?"A":"I";this.benefitList=this.benefitList.map(l=>{if(l.id_beneficio==n){if(t){const{id_beneficio:p,tiempo:v}=l;this.selectedBenefits.push({id_beneficio:p,tiempo:v})}else this.selectedBenefits=this.selectedBenefits.filter(p=>p.id_beneficio!=n);l.estado=o}return l})}changeTime(t){t.editar=!1,this.selectedBenefits=this.selectedBenefits.map(n=>(n.id_beneficio==t.id_beneficio&&(n.tiempo=t.tiempo),n))}updateBenefits(){this._placeService.updateBenefits({id_lugar:this.placeId,lista:this.selectedBenefits,usuario_modificacion:"admin"}).subscribe({next:()=>{this.onlyPermissions?this._dialogService.close(!0):this.showToast("success","Beneficios actualizados")},error:()=>{this.showToast("danger","Error al actualizar")}})}showToast(t,n){this._toastrService.show("",n,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:u.fe3.TOP_RIGHT,preventDuplicates:!0})}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(I.k),e.\u0275\u0275directiveInject(u.quB),e.\u0275\u0275directiveInject(u.X4l))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-benefits"]],inputs:{placeId:"placeId",onlyPermissions:"onlyPermissions"},decls:12,vars:1,consts:[[1,"row","detail-container"],[1,"col-lg-12"],[1,"row"],[4,"ngFor","ngForOf"],[1,"row","pt-1"],[1,"col-12"],["nbButton","","status","info","hero","",3,"click"],[1,"col-6","py-1","d-flex","align-items-center"],[3,"checked","checkedChange"],[4,"ngIf"],["class","pl-2",4,"ngIf"],["class","cursor-pointer pl-2",3,"click",4,"ngIf"],["class","ml-2","type","number","nbInput","","fullWidth","","fieldSize","small","placeholder","Tiempo",3,"ngModel","ngModelChange",4,"ngIf"],["nbButton","","size","small","class","ml-2",3,"click",4,"ngIf"],[1,"pl-2"],[1,"cursor-pointer","pl-2",3,"click"],["type","number","nbInput","","fullWidth","","fieldSize","small","placeholder","Tiempo",1,"ml-2",3,"ngModel","ngModelChange"],["nbButton","","size","small",1,"ml-2",3,"click"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header"),e.\u0275\u0275text(4,"Seleccionar beneficios"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"nb-card-body")(6,"div",2),e.\u0275\u0275template(7,j,5,3,"ng-container",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",4)(9,"div",5)(10,"button",6),e.\u0275\u0275listener("click",function(){return n.updateBenefits()}),e.\u0275\u0275text(11,"Actualizar"),e.\u0275\u0275elementEnd()()()()()()()),2&t&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",n.benefitList))},dependencies:[a.sg,a.O5,d.Fj,d.wV,d.JJ,d.On,u.Asz,u.yKW,u.ndF,u.DPz,u.h8i,u.NTf],styles:[".detail-container[_ngcontent-%COMP%]{width:1080px}"]}),i})();var w=c(7672),M=c(37556),x=c(5527),k=c(44949),m=c(97007),h=c(62774);function s(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",43),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.save())}),e.\u0275\u0275text(1," Guardar "),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",!t.placeForm.valid)}}function _(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_tipo),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function f(i,r){if(1&i&&e.\u0275\u0275element(0,"nb-user",45),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("onlyPicture",!0)("picture",t.placeImage)}}function b(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"input",46,47),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275reference(1),l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.loadFile(o.files))}),e.\u0275\u0275elementEnd()}}function V(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",48),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.uploadImage())}),e.\u0275\u0275text(1,"Actualizar imagen"),e.\u0275\u0275elementEnd()}}function F(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function O(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,F,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("nombre").hasError("required"))}}function z(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function N(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,z,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("primario").hasError("required"))}}function R(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function W(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,R,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("secundario").hasError("required"))}}function $(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function G(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,$,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("dominio").hasError("required"))}}function U(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",51),e.\u0275\u0275element(2,"input",52),e.\u0275\u0275template(3,G,2,1,"ng-container",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.placeForm.get("dominio").invalid&&t.placeForm.get("dominio").touched)}}function J(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_pais),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function K(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_provincia),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function Z(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",44),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.id_ciudad),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.nombre," ")}}function H(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function X(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,H,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("id_ciudad").hasError("required"))}}function Y(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function Q(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Y,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("latitud").hasError("required"))}}function q(i,r){1&i&&(e.\u0275\u0275elementStart(0,"p",50),e.\u0275\u0275text(1," El campo es obligatorio "),e.\u0275\u0275elementEnd())}function ee(i,r){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,q,2,0,"p",49),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.placeForm.get("longitud").hasError("required"))}}function te(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",53)(1,"ngx-map",54),e.\u0275\u0275listener("mapClicked",function(o){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.onMapClicked(o))}),e.\u0275\u0275elementEnd()()}if(2&i){const t=r.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("latitude",t.latitude)("longitude",t.longitude)("address",t.address)}}const D=function(){return{standalone:!0}};let ne=(()=>{class i{constructor(t,n,o,l,p,v,ie,oe,re,ae){this._formBuilder=t,this._activatedRoute=n,this._dialogService=o,this._authService=l,this._placeService=p,this._toastrService=v,this._countryService=ie,this._provinceService=oe,this._cityService=re,this._cdRef=ae,this.showUploadButton=!1,this.types=[],this.countries=[],this.provinces=[],this.cities=[],this.showDomain=!1,this.isAdmin=this._authService.isAdmin(),this._activatedRoute.params.subscribe(le=>{this.placeId=le.placeId}),this.initForm(),this.getTypes(),this.getCountries()}ngOnInit(){this.placeId?(this.getPlace(),this.action="Editar"):this.action="Crear"}initForm(){this.placeForm=this._formBuilder.group({id_tipo:["",d.kI.required],id_ciudad:["",d.kI.required],nombre:["",d.kI.required],descripcion:["",d.kI.required],latitud:["",d.kI.required],longitud:["",d.kI.required],imagen:["",d.kI.required],primario:["",d.kI.required],secundario:["",d.kI.required],dominio:[""],usuario_creacion:["admin",d.kI.required]})}getPlace(){var n,t=this;this._placeService.getPlace({id_lugar:this.placeId}).subscribe({next:(n=(0,C.Z)(function*(o){t.placeForm.patchValue(o),t.placeImage=`${g.N.storageUrl}/Lugar/${o.imagen}`,t.selectedCountry=o.id_pais,yield t.getProvinces(t.selectedCountry),t.selectedProvince=o.id_provincia,yield t.getCities(t.selectedProvince),t.selectedCity=o.id_ciudad,t.placeForm.get("dominio").value&&(t.showDomain=!0,t.placeForm.controls.dominio.setValidators(d.kI.required)),t._cdRef.detectChanges()}),function(l){return n.apply(this,arguments)}),error:n=>{console.error(n)}})}getTypes(){this._placeService.getTypes({id_usuario:"1"}).subscribe({next:t=>{this.types=t,this.selectType(this.types[0].id_tipo)},error:t=>{console.error(t)}})}getCountries(){this._countryService.getAll({id_usuario:"1"}).subscribe({next:t=>{this.countries=t.filter(n=>"A"===n.estado)},error:t=>{console.error(t)}})}getProvinces(t){var n=this;return(0,C.Z)(function*(){return new Promise(o=>{n._provinceService.getByCountry({id_usuario:"1",id_pais:t}).subscribe({next:p=>{n.provinces=p.filter(v=>"A"===v.estado),setTimeout(()=>o(),0)}})})})()}getCities(t){var n=this;return(0,C.Z)(function*(){return new Promise(o=>{n._cityService.getByProvince({id_usuario:"1",id_provincia:t}).subscribe({next:p=>{n.cities=p.filter(v=>"A"===v.estado),setTimeout(()=>o(),0)}})})})()}onMapClicked(t){this.placeForm.patchValue({latitud:t.latitud,longitud:t.longitud}),this.mapModal.close()}getAddressItem(t,n){return t.filter(o=>o.type==n)[0].description}showMap(t){this.mapModal=this._dialogService.open(t,{context:{latitude:this.placeForm.get("latitud").value,longitude:this.placeForm.get("longitud").value,address:this.getAddress()}})}getAddress(){let t="";return this.countries.map(n=>{n.id_pais==this.selectedCountry&&(t+=n.nombre+" ")}),this.provinces.map(n=>{n.id_provincia==this.selectedProvince&&(t+=n.nombre+" ")}),this.cities.map(n=>{n.id_ciudad==this.placeForm.get("id_ciudad").value&&(t+=n.nombre+" ")}),t}loadFile(t){if(!t.length)return;const n=t[0],o=new FileReader;o.onload=()=>{this.placeForm.patchValue({imagen:n}),this.placeImage=o.result,this.placeId&&(this.showUploadButton=!0),this._cdRef.detectChanges()},o.readAsDataURL(n)}uploadImage(){const t=new FormData;t.append("imagen",this.placeForm.value.imagen),t.append("id_lugar",this.placeId),t.append("usuario_modificacion","admin"),this._placeService.updateImage(t).subscribe({next:n=>{this.showToast("success","Imagen actualizada"),this.showUploadButton=!1,this._cdRef.detectChanges()},error:n=>{this.showToast("danger","Error al subir la imagen")}})}save(){const t=new FormData;Object.keys(this.placeForm.value).forEach(n=>{"dominio"==n&&!this.showDomain&&this.placeForm.get(n).setValue(""),("imagen"!==n||!this.placeId)&&t.append(n,this.placeForm.value[n])}),this.placeId?this.update(this.placeForm.value):this.create(t)}create(t){this._placeService.create(t).subscribe({next:()=>{this.showToast("success","Lugar creado")}})}update(t){const{usuario_creacion:n,imagen:o,...l}=t,p={...l,id_lugar:this.placeId,usuario_modificacion:"admin"};this._placeService.update(p).subscribe({next:()=>{this.showToast("success","Lugar actualizado")}})}showToast(t,n){this._toastrService.show("",n,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:u.fe3.TOP_RIGHT,preventDuplicates:!0})}onCountryChange(t){var n=this;return(0,C.Z)(function*(){n.selectedProvince=null,n.onProvinceChange(null),yield n.getProvinces(t)})()}onProvinceChange(t){var n=this;this.selectedCity=null,setTimeout((0,C.Z)(function*(){n.cities=null,n.selectCity(null),t&&(yield n.getCities(t))}),0)}selectType(t){this.placeForm.patchValue({id_tipo:t})}selectCity(t){this.placeForm.patchValue({id_ciudad:t})}toggleDomain(){this.showDomain?this.placeForm.controls.dominio.setValidators(d.kI.required):(this.placeForm.controls.dominio.removeValidators(d.kI.required),this.placeForm.controls.dominio.setErrors(null)),setTimeout(()=>{this._cdRef.detectChanges()},0)}showBenefits(){this._dialogService.open(B,{context:{placeId:this.placeId}})}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(d.qu),e.\u0275\u0275directiveInject(w.gz),e.\u0275\u0275directiveInject(u.Gln),e.\u0275\u0275directiveInject(M.e),e.\u0275\u0275directiveInject(I.k),e.\u0275\u0275directiveInject(u.quB),e.\u0275\u0275directiveInject(x.T),e.\u0275\u0275directiveInject(k.f),e.\u0275\u0275directiveInject(m.Z),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-place-form"]],decls:107,vars:28,consts:[[1,"row"],[1,"col-lg-12"],[1,"w-100","d-flex","justify-content-between"],["nbButton","","status","info","hero","",3,"disabled","click",4,"ngIf"],[3,"formGroup"],[1,"col-sm-4"],[1,"form-group"],["for","inputTipo",1,"label"],["fullWidth","","id","inputTipo","formControlName","id_tipo","placeholder","Seleccionar una opci\xf3n",3,"selected"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-8"],["for","inputImagen",1,"label"],[1,"d-flex","align-items-center"],[3,"onlyPicture","picture",4,"ngIf"],["id","inputImagen","class","pl-2","type","file","fullWidth","",3,"change",4,"ngIf"],["nbButton","","ghost","","status","info",3,"click",4,"ngIf"],["for","inputNombre",1,"label"],["id","inputNombre","type","text","nbInput","","fullWidth","","placeholder","Nombre","formControlName","nombre"],[4,"ngIf"],["for","inputDescripcion",1,"label"],["id","inputDescripcion","type","text","nbInput","","fullWidth","","placeholder","Descripci\xf3n","formControlName","descripcion"],["for","inputPrimario",1,"label"],["id","inputPrimario","type","text","nbInput","","fullWidth","","placeholder","Primario","formControlName","primario"],["for","inputSecundario",1,"label"],["id","inputSecundario","type","text","nbInput","","fullWidth","","placeholder","Secundario","formControlName","secundario"],["for","inputDominio",1,"label"],[1,"d-flex","align-items-start"],["status","success",3,"checked","checkedChange"],["nbButton","",3,"click"],[1,"mt-4"],["for","inputPais",1,"label"],["fullWidth","","id","inputPais","placeholder","Seleccione una opci\xf3n","required","",3,"ngModel","ngModelOptions","selectedChange","ngModelChange"],["for","inputProvincia",1,"label"],["fullWidth","","id","inputProvincia","placeholder","Seleccione una opci\xf3n",3,"ngModel","ngModelOptions","selectedChange","ngModelChange"],["for","inputCiudad",1,"label"],["fullWidth","","id","inputCiudad","placeholder","Seleccione una opci\xf3n",3,"ngModel","ngModelOptions","selectedChange","ngModelChange"],["for","inputLatitud",1,"label"],["id","inputLatitud","type","text","nbInput","","fullWidth","","placeholder","Latitud","formControlName","latitud"],["for","inputLongitud",1,"label"],["id","inputLongitud","type","text","nbInput","","fullWidth","","placeholder","Longitud","formControlName","longitud"],[1,"form-group","mb-0","mt-4"],["nbButton","","status","info","ghost","",3,"click"],["map",""],["nbButton","","status","info","hero","",3,"disabled","click"],[3,"value"],[3,"onlyPicture","picture"],["id","inputImagen","type","file","fullWidth","",1,"pl-2",3,"change"],["fileControl",""],["nbButton","","ghost","","status","info",3,"click"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"],[1,"ml-2"],["id","inputDominio","type","text","nbInput","","fullWidth","","placeholder","Dominio","formControlName","dominio"],[1,"map-container"],[3,"latitude","longitude","address","mapClicked"]],template:function(t,n){if(1&t){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header",2)(4,"h5"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div"),e.\u0275\u0275template(7,s,2,1,"button",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"nb-card-body")(9,"form",4)(10,"fieldset")(11,"legend"),e.\u0275\u0275text(12,"Informaci\xf3n del lugar"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",0)(14,"div",5)(15,"div",6)(16,"label",7),e.\u0275\u0275text(17,"Tipo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"nb-select",8),e.\u0275\u0275template(19,_,2,2,"nb-option",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(20,"div",10)(21,"div",6)(22,"label",11),e.\u0275\u0275text(23,"Imagen"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"div",12),e.\u0275\u0275template(25,f,1,2,"nb-user",13),e.\u0275\u0275template(26,b,2,0,"input",14),e.\u0275\u0275template(27,V,2,0,"button",15),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(28,"div",0)(29,"div",5)(30,"div",6)(31,"label",16),e.\u0275\u0275text(32,"Nombre"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(33,"input",17),e.\u0275\u0275template(34,O,2,1,"ng-container",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(35,"div",10)(36,"div",6)(37,"label",19),e.\u0275\u0275text(38,"Descripci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(39,"input",20),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(40,"div",0)(41,"div",5)(42,"div",6)(43,"label",21),e.\u0275\u0275text(44,"Primario"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(45,"input",22),e.\u0275\u0275template(46,N,2,1,"ng-container",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(47,"div",5)(48,"div",6)(49,"label",23),e.\u0275\u0275text(50,"Secundario"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(51,"input",24),e.\u0275\u0275template(52,W,2,1,"ng-container",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(53,"div",5)(54,"div",6)(55,"label",25),e.\u0275\u0275text(56,"Dominio"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(57,"div",26)(58,"nb-toggle",27),e.\u0275\u0275listener("checkedChange",function(p){return n.showDomain=p})("checkedChange",function(){return n.toggleDomain()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(59,U,4,1,"ng-container",18),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(60,"div",0)(61,"div",5)(62,"div",6)(63,"button",28),e.\u0275\u0275listener("click",function(){return n.showBenefits()}),e.\u0275\u0275text(64,"Seleccionar beneficios"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(65,"fieldset",29)(66,"legend"),e.\u0275\u0275text(67,"Ubicaci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(68,"div",0)(69,"div",5)(70,"div",6)(71,"label",30),e.\u0275\u0275text(72,"Pa\xeds"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(73,"nb-select",31),e.\u0275\u0275listener("selectedChange",function(p){return n.onCountryChange(p)})("ngModelChange",function(p){return n.selectedCountry=p}),e.\u0275\u0275template(74,J,2,2,"nb-option",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(75,"div",5)(76,"div",6)(77,"label",32),e.\u0275\u0275text(78,"Provincia"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(79,"nb-select",33),e.\u0275\u0275listener("selectedChange",function(p){return n.onProvinceChange(p)})("ngModelChange",function(p){return n.selectedProvince=p}),e.\u0275\u0275template(80,K,2,2,"nb-option",9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(81,"div",5)(82,"div",6)(83,"label",34),e.\u0275\u0275text(84,"Ciudad"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(85,"nb-select",35),e.\u0275\u0275listener("selectedChange",function(p){return n.selectCity(p)})("ngModelChange",function(p){return n.selectedCity=p}),e.\u0275\u0275template(86,Z,2,2,"nb-option",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(87,X,2,1,"ng-container",18),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(88,"div",0)(89,"div",5)(90,"div",6)(91,"label",36),e.\u0275\u0275text(92,"Latitud"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(93,"input",37),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(94,Q,2,1,"ng-container",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(95,"div",5)(96,"div",6)(97,"label",38),e.\u0275\u0275text(98,"Longitud"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(99,"input",39),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(100,ee,2,1,"ng-container",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(101,"div",5)(102,"div",40)(103,"button",41),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const p=e.\u0275\u0275reference(106);return e.\u0275\u0275resetView(n.showMap(p))}),e.\u0275\u0275text(104,"Ver mapa"),e.\u0275\u0275elementEnd()()()()()()()()()(),e.\u0275\u0275template(105,te,2,3,"ng-template",null,42,e.\u0275\u0275templateRefExtractor)}2&t&&(e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",n.action," Lugar"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.isAdmin),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",n.placeForm),e.\u0275\u0275advance(9),e.\u0275\u0275property("selected",null==n.types[0]?null:n.types[0].id_tipo),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.types),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.placeImage),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isAdmin),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showUploadButton),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.placeForm.get("nombre").invalid&&n.placeForm.get("nombre").touched),e.\u0275\u0275advance(12),e.\u0275\u0275property("ngIf",n.placeForm.get("primario").invalid&&n.placeForm.get("primario").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.placeForm.get("secundario").invalid&&n.placeForm.get("secundario").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("checked",n.showDomain),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showDomain),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngModel",n.selectedCountry)("ngModelOptions",e.\u0275\u0275pureFunction0(25,D)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.countries),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",n.selectedProvince)("ngModelOptions",e.\u0275\u0275pureFunction0(26,D)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.provinces),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",n.selectedCity)("ngModelOptions",e.\u0275\u0275pureFunction0(27,D)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.cities),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.placeForm.get("id_ciudad").invalid&&n.placeForm.get("id_ciudad").touched),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.placeForm.get("latitud").invalid&&n.placeForm.get("latitud").touched),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.placeForm.get("longitud").invalid&&n.placeForm.get("longitud").touched))},dependencies:[a.sg,a.O5,h.G,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.On,d.sg,d.u,u.Asz,u.yKW,u.ndF,u.DPz,u.h8i,u.rs,u.q51,u.k0$,u.BLq],styles:[".map-container[_ngcontent-%COMP%]{padding:20px;background-color:#fff}nb-card[_ngcontent-%COMP%]{border-radius:0;border-top:0}"],changeDetection:0}),i})()},97662:(A,y,c)=>{c.r(y),c.d(y,{PlacesModule:()=>k});var C=c(9434),d=c(7672),u=c(14019),g=c(36517),e=c(74385),I=c(36749),a=c(30551),P=c(37556),S=c(12368),E=c(36895);function T(m,h){if(1&m){const s=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"button",4),a.\u0275\u0275listener("click",function(){a.\u0275\u0275restoreView(s);const f=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(f.add())}),a.\u0275\u0275text(1," Nuevo "),a.\u0275\u0275elementEnd()}}const B=[{path:"",component:(()=>{class m{constructor(){}}return m.\u0275fac=function(s){return new(s||m)},m.\u0275cmp=a.\u0275\u0275defineComponent({type:m,selectors:[["ngx-places"]],decls:1,vars:0,template:function(s,_){1&s&&a.\u0275\u0275element(0,"router-outlet")},dependencies:[d.lC],encapsulation:2}),m})(),children:[{path:"",component:(()=>{class m{constructor(s,_,f,b){this.router=s,this._authService=_,this._placeService=f,this._toastrService=b,this.settings={actions:{position:"right",add:!1,edit:!1,delete:!1,custom:[{name:"edit",title:'<i class="nb-edit"></i>'}]},columns:{nombre:{title:"Nombre",type:"string"},tipo:{title:"Tipo",type:"string"},descripcion:{title:"Descripcion",type:"string"},estado:{title:"Estado",type:"custom",renderComponent:I.P,onComponentInitFunction:V=>{V.toggle.subscribe(F=>{this.updateStatus(F.row.id_lugar,F.value?"A":"I")})}}}},this.source=new e.nC,this.isAdmin=this._authService.isAdmin()}ngOnInit(){this.getPlaces()}getPlaces(){this._placeService.getPlaces({id_usuario:"1"}).subscribe({next:s=>{const _=s.filter(f=>"E"!=f.estado);this.source.load(_)},error:s=>{console.error(s)}})}onDeleteConfirm(s){window.confirm("Are you sure you want to delete?")?s.confirm.resolve():s.confirm.reject()}onCustom(s){"edit"===s.action&&(this._placeService.setPlace(s.data),this.router.navigate([`/pages/lugares/${s.data.id_lugar}`]))}add(){this.router.navigate(["/pages/lugares/crear"])}updateStatus(s,_){this._placeService.updateStatus({id_lugar:s,estado:_,usuario_modificacion:"admin"}).subscribe({next:()=>{this.showToast("success","Estado de lugar actualizado")},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}showToast(s,_){this._toastrService.show("",_,{status:s,destroyByClick:!0,duration:3e3,hasIcon:!1,position:g.fe3.TOP_RIGHT,preventDuplicates:!0})}}return m.\u0275fac=function(s){return new(s||m)(a.\u0275\u0275directiveInject(d.F0),a.\u0275\u0275directiveInject(P.e),a.\u0275\u0275directiveInject(S.k),a.\u0275\u0275directiveInject(g.quB))},m.\u0275cmp=a.\u0275\u0275defineComponent({type:m,selectors:[["ngx-places-list"]],decls:8,vars:3,consts:[[1,"w-100","d-flex","justify-content-between"],[1,""],["nbButton","","status","info","hero","",3,"click",4,"ngIf"],[1,"custom-table",3,"settings","source","custom","deleteConfirm"],["nbButton","","status","info","hero","",3,"click"]],template:function(s,_){1&s&&(a.\u0275\u0275elementStart(0,"nb-card")(1,"nb-card-header",0)(2,"h5"),a.\u0275\u0275text(3,"Lugares"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(4,"div",1),a.\u0275\u0275template(5,T,2,0,"button",2),a.\u0275\u0275elementEnd()(),a.\u0275\u0275elementStart(6,"nb-card-body")(7,"ng2-smart-table",3),a.\u0275\u0275listener("custom",function(b){return _.onCustom(b)})("deleteConfirm",function(b){return _.onDeleteConfirm(b)}),a.\u0275\u0275elementEnd()()()),2&s&&(a.\u0275\u0275advance(5),a.\u0275\u0275property("ngIf",_.isAdmin),a.\u0275\u0275advance(2),a.\u0275\u0275property("settings",_.settings)("source",_.source))},dependencies:[E.O5,g.Asz,g.yKW,g.ndF,e.T5,g.DPz],styles:["[_nghost-%COMP%]     tr .ng2-smart-actions{height:auto}[_nghost-%COMP%]     ng2-st-tbody-custom{display:flex}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom{display:inline-block;text-align:center}"]}),m})()},{path:"crear",component:u.C},{path:":placeId",loadChildren:()=>Promise.all([c.e(609),c.e(132)]).then(c.bind(c,75132)).then(m=>m.PlaceDetailModule)}]}];let w=(()=>{class m{}return m.\u0275fac=function(s){return new(s||m)},m.\u0275mod=a.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=a.\u0275\u0275defineInjector({imports:[d.Bz.forChild(B),d.Bz]}),m})();var M=c(92661),x=c(24006);let k=(()=>{class m{}return m.\u0275fac=function(s){return new(s||m)},m.\u0275mod=a.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=a.\u0275\u0275defineInjector({imports:[C.O,x.u5,x.UX,w,g.zyh,e.ne,g.T2N,g.nKr,g.IIj,M.Y4,g.AE1,g.COg,g.KdK,g.EoG,g.j5J,g.obu,g.wB1,g.MfT]}),m})()}}]);