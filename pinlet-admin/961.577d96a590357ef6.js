"use strict";(self.webpackChunkngx_admin_demo=self.webpackChunkngx_admin_demo||[]).push([[961],{22961:(B,f,a)=>{a.r(f),a.d(f,{NotificationsModule:()=>E});var h=a(97137),s=a(36517),l=a(24006),u=a(7672),e=a(30551);let v=(()=>{class i{constructor(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-notifications"]],decls:1,vars:0,template:function(t,o){1&t&&e.\u0275\u0275element(0,"router-outlet")},dependencies:[u.lC],encapsulation:2}),i})();var g=a(12368),y=a(18328),I=a(12013),m=a(36895),F=a(20732),C=a(5180);const b=["inputIdPrimario"];function _(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",19),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.value),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.title," ")}}function N(i,r){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14)(1,"div",8)(2,"label",15),e.\u0275\u0275text(3,"Primario"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"nb-select",16,17),e.\u0275\u0275listener("selectedChange",function(n){e.\u0275\u0275restoreView(t);const c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.getSecundarios(n))}),e.\u0275\u0275template(6,_,2,2,"nb-option",18),e.\u0275\u0275elementEnd()()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.primarios)}}function x(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"nb-option",19),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=r.$implicit;e.\u0275\u0275property("value",t.value),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.title," ")}}function S(i,r){if(1&i&&(e.\u0275\u0275elementStart(0,"div",14)(1,"div",8)(2,"label",20),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"ngxCapitalize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"nb-select",21),e.\u0275\u0275template(6,x,2,2,"nb-option",18),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,2,t.selectedType)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.optionValues)}}let p=(()=>{class i{constructor(t,o,n,c,d,j){this._formBuilder=t,this._activatedRoute=o,this._placeService=n,this._residentService=c,this._notificationService=d,this._toastrService=j,this.typeOptions=[{title:"Residente",value:"id_residente_lugar"},{title:"Secundario",value:"id_secundario"},{title:"Primario",value:"id_primario"},{title:"Lugar",value:"id_lugar"}],this.optionValues=[],this.primarios=[]}ngOnInit(){this.placeId=parseInt(this._activatedRoute.parent.parent.parent.snapshot.paramMap.get("placeId")),this.selectedType=this._activatedRoute.snapshot.url[0].path,this.initForm(),this.loadValues(this.selectedType)}initForm(){this.notificationForm=this._formBuilder.group({tipo:["",l.kI.required],id:["",l.kI.required],titulo:["",l.kI.required],descripcion:[""],estado:"A"})}loadValues(t){const n={id_usuario:1};switch(t){case"lugar":this.notificationForm.patchValue({tipo:"id_lugar",id:this.placeId});break;case"primario":this.notificationForm.patchValue({tipo:"id_primario"}),n.id_lugar=this.placeId,this.getPrimarios(n);break;case"secundario":this.notificationForm.patchValue({tipo:"id_secundario"}),n.id_lugar=this.placeId,this.getPrimarios(n);break;case"residente":this.notificationForm.patchValue({tipo:"id_residente_lugar"}),n.id_lugar=this.placeId,n.estado="T",this._residentService.getByPlace(n).subscribe({next:c=>{this.optionValues=c.map(d=>({title:`${d.nombres} ${d.apellidos}`,value:d.id_residente_lugar}))},error:c=>{}})}}getPrimarios(t){this._placeService.getPrimarios(t).subscribe({next:o=>{this.optionValues=o.map(n=>({title:n.nombre_primario,value:n.id_primario})),this.primarios=this.optionValues},error:o=>{}})}onPrimarioSelected(t){this.getSecundarios(t)}getSecundarios(t){this._placeService.getSecundarios({id_usuario:1,id_primario:t}).subscribe({next:n=>{this.optionValues=n.map(c=>({title:c.nombre_secundario,value:c.id_secundario}))},error:n=>{}})}send(){this._notificationService.send(this.notificationForm.value).subscribe({next:()=>{this.selectPrimario&&(this.selectPrimario.selected=null),this.notificationForm.patchValue({titulo:null,descripcion:null}),this.showToast("success","Notificaci\xf3n enviada")},error:()=>{this.showToast("danger","Ha ocurrido un error. Intente nuevamente")}})}showToast(t,o){this._toastrService.show("",o,{status:t,destroyByClick:!0,duration:3e3,hasIcon:!1,position:s.fe3.TOP_RIGHT,preventDuplicates:!0})}}return i.\u0275fac=function(t){return new(t||i)(e.\u0275\u0275directiveInject(l.qu),e.\u0275\u0275directiveInject(u.gz),e.\u0275\u0275directiveInject(g.k),e.\u0275\u0275directiveInject(y.B),e.\u0275\u0275directiveInject(I.g),e.\u0275\u0275directiveInject(s.quB))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ngx-notification-form"]],viewQuery:function(t,o){if(1&t&&e.\u0275\u0275viewQuery(b,5),2&t){let n;e.\u0275\u0275queryRefresh(n=e.\u0275\u0275loadQuery())&&(o.selectPrimario=n.first)}},decls:28,vars:4,consts:[[1,"row"],[1,"col-lg-12"],[1,"w-100","d-flex","justify-content-between"],[1,"d-flex","align-items-center","h5"],["nbButton","","status","info","hero","",3,"click"],[3,"formGroup"],["class","col-sm-6",4,"ngIf"],[3,"ngClass"],[1,"form-group"],["for","inputTitulo",1,"label"],["type","text","nbInput","","fullWidth","","id","inputTitulo","placeholder","T\xedtulo","formControlName","titulo"],[1,"col-sm-12"],["for","inputDescripcion",1,"label"],["type","text","nbInput","","fullWidth","","id","inputDescripcion","placeholder","Descripci\xf3n","formControlName","descripcion"],[1,"col-sm-6"],["for","inputIdPrimario",1,"label"],["fullWidth","","id","inputIdPrimario","placeholder","Seleccione una opci\xf3n",3,"selectedChange"],["inputIdPrimario",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","inputIdTipo",1,"label"],["fullWidth","","id","inputIdTipo","placeholder","Seleccione una opci\xf3n","formControlName","id"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"ngx-no-padding-layout")(1,"div",0)(2,"div",1)(3,"nb-card")(4,"nb-card-header",2)(5,"div",3)(6,"h5"),e.\u0275\u0275text(7,"Notificaciones"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div")(9,"button",4),e.\u0275\u0275listener("click",function(){return o.send()}),e.\u0275\u0275text(10," Enviar "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(11,"nb-card-body")(12,"form",5)(13,"div",0),e.\u0275\u0275template(14,N,7,1,"div",6),e.\u0275\u0275template(15,S,7,4,"div",6),e.\u0275\u0275elementStart(16,"div",7)(17,"div",8)(18,"label",9),e.\u0275\u0275text(19,"T\xedtulo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"input",10),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(21,"div",0)(22,"div",11)(23,"div",8)(24,"label",12),e.\u0275\u0275text(25,"Descripci\xf3n"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"textarea",13),e.\u0275\u0275text(27,"\t\t\t\t\t\t\t\t\t"),e.\u0275\u0275elementEnd()()()()()()()()()()),2&t&&(e.\u0275\u0275advance(12),e.\u0275\u0275property("formGroup",o.notificationForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","secundario"===o.selectedType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","lugar"!==o.selectedType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass","lugar"===o.selectedType||"secundario"===o.selectedType?"col-sm-12":"col-sm-6"))},dependencies:[m.mk,m.sg,m.O5,F.F,s.Asz,s.yKW,s.ndF,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,s.h8i,s.rs,s.q51,s.DPz,C.e]}),i})();const T=[{path:"",component:v,children:[{path:"lugar",component:p},{path:"primario",component:p},{path:"secundario",component:p},{path:"residente",component:p}]}];let P=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.Bz.forChild(T),u.Bz]}),i})();var V=a(74385);let E=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i}),i.\u0275inj=e.\u0275\u0275defineInjector({imports:[h.O,P,s.zyh,l.u5,l.UX,s.nKr,s.IIj,s.T2N,V.ne]}),i})()}}]);